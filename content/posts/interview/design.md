---
title: "设计题"
date: 2022-08-21T10:43:43+08:00
draft: false
tags: [""]
categories: ["面试"]
typora-root-url: ..\..\static
---



### 微信扫码登录原理

1. 浏览器从服务器端获得一个`uuid`(唯一ID)，将这个 `uuid` 作为key值存入redis服务器，同时设置一个过期时间，一旦过期后，用户登录二维码需要进行刷新重新获取。
2. 将这个key值和公司的验证字符串合在一起，通过二维码生成接口，生成一个二维码的图片。然后，将二维码图片和 `uuid` 一起返回。
3. 浏览器轮询服务器，获得扫码状态。
4. 根据服务器返回的扫码状态，进行相应的操作
   1. 408 扫码超时 如果手机没有扫码或没有授权登录，服务器会阻塞约25s，然后返回状态码 408 -> 前端继续轮询
   2. 400 二维码失效 大约5分钟的时间内不扫码，二维码失效
   3. 201 已扫码 如果手机已经扫码，服务器立即返回状态码和用户的基本信息 （window.code=201,window.code.userAvator="..."），-> 前端继续轮询
   4. 200 已授权 如果手机点击了确认登录，服务器返回200及token -> 前端停止轮询, 获取到token，重定向到目标页

[阿里面试官：分别说说微信和淘宝扫码登录背后的实现原理？](https://cloud.tencent.com/developer/article/1589934?cps_key=1d358d18a7a17b4a6df8d67a62fd3d3d)